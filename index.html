<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="keyboard.css" />
		<script src="keyboard.js" charset="UTF-8"></script>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
	</head>
	<body>
		<input type="text" class="keyboardInput">
		<button type="button" onclick="VKI_close();">Close Keyboard</button>
		<script>
			function addEvent( obj, type, fn )
			{
				if (obj.addEventListener)
					obj.addEventListener( type, fn, false );
				else if (obj.attachEvent)
				{
					obj["e"+type+fn] = fn;
					obj[type+fn] = function() { obj["e"+type+fn]( window.event ); }
					obj.attachEvent( "on"+type, obj[type+fn] );
				}
			}
			 
			function removeEvent( obj, type, fn )
			{
				if (obj.removeEventListener)
					obj.removeEventListener( type, fn, false );
				else if (obj.detachEvent)
				{
					obj.detachEvent( "on"+type, obj[type+fn] );
					obj[type+fn] = null;
					obj["e"+type+fn] = null;
				}
			}

	var keyboard_map = function setKeyboardMap() {
		var mapping = VKI_layout[VKI_kt].keys;
	   	var keyboard_map = {
	   	192:[mapping[0][0][0],mapping[0][0][1]],
	   	49:[mapping[0][1][0],mapping[0][1][1]],
	   	50:[mapping[0][2][0],mapping[0][2][1]],
	   	51:[mapping[0][3][0],mapping[0][3][1]],
	   	52:[mapping[0][4][0],mapping[0][4][1]],
	   	53:[mapping[0][5][0],mapping[0][5][1]],
	   	54:[mapping[0][6][0],mapping[0][6][1]],
	   	55:[mapping[0][7][0],mapping[0][7][1]],
	   	56:[mapping[0][8][0],mapping[0][8][1]],
	   	57:[mapping[0][9][0],mapping[0][9][1]],
	   	48:[mapping[0][10][0],mapping[0][10][1]],
	   	189:[mapping[0][11][0],mapping[0][11][1]],
	   	187:[mapping[0][12][0],mapping[0][12][1]],
	   	81:[mapping[1][1][0],mapping[1][1][1]],
	   	87:[mapping[1][2][0],mapping[1][2][1]],
	   	69:[mapping[1][3][0],mapping[1][2][1]],
	   	82:[mapping[1][4][0],mapping[1][4][1]],
	   	84:[mapping[1][5][0],mapping[1][5][1]],
	   	89:[mapping[1][6][0],mapping[1][6][1]],
	   	85:[mapping[1][7][0],mapping[1][7][1]],
	   	73:[mapping[1][8][0],mapping[1][8][1]],
	   	79:[mapping[1][9][0],mapping[1][9][1]],
	   	80:[mapping[1][10][0],mapping[1][10][1]],
	   	219:[mapping[1][11][0],mapping[1][11][1]],
	   	221:[mapping[1][12][0],mapping[1][12][1]],
	   	65:[mapping[2][1][0],mapping[2][1][1]],
	   	83:[mapping[2][2][0],mapping[2][2][1]],
	   	68:[mapping[2][3][0],mapping[2][3][1]],
	   	70:[mapping[2][4][0],mapping[2][4][1]],
	   	71:[mapping[2][5][0],mapping[2][5][1]],
	   	72:[mapping[2][6][0],mapping[2][6][1]],
	   	74:[mapping[2][7][0],mapping[2][7][1]],
	   	75:[mapping[2][8][0],mapping[2][8][1]],
	   	76:[mapping[2][9][0],mapping[2][9][1]],
	   	186:[mapping[2][10][0],mapping[2][10][1]],
	   	222:[mapping[2][11][0],mapping[2][11][1]],
	   	51:[mapping[1][13][0],mapping[1][13][1]],
	   	90:[mapping[3][1][0],mapping[3][1][1]],
	   	88:[mapping[3][2][0],mapping[3][2][1]],
	   	67:[mapping[3][3][0],mapping[3][3][1]],
	   	86:[mapping[3][4][0],mapping[3][4][1]],
	   	66:[mapping[3][5][0],mapping[3][5][1]],
	   	78:[mapping[3][6][0],mapping[3][6][1]],
	   	77:[mapping[3][7][0],mapping[3][7][1]],
	   	188:[mapping[3][8][0],mapping[3][8][1]],
	   	190:[mapping[3][9][0],mapping[3][9][1]],
	   	191:[mapping[3][10][0],mapping[3][10][1]]
		};
		return keyboard_map;
	}
	
	function getKeyboardMap(e){
	{
		if(VKI_target){
		e.preventDefault();
		var keyboard_input = $('.keyboardInput');
				if(keyboard_map()[e.keyCode] != undefined || ''){
					if(VKI_shift || VKI_shiftlock){
						keyboard_input.val(keyboard_input.val()+keyboard_map()[e.keyCode][1]);
					} else {
						keyboard_input.val(keyboard_input.val()+keyboard_map()[e.keyCode][0]);
					}
				}
			} else {
				removeEvent(this, 'keydown', getKeyboardMap);
			}
		}
	}
	
	addEvent(this, 'keydown', getKeyboardMap);

		</script>
	</body>
</html>